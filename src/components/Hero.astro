---
import "../styles/components/_hero.scss";

const {
  badgeText = "Respuesta a presupuestos en 24h",
  titleBefore = "Sitios web entregados",
  titleAccent = "rápido",
  titleAfter = ", con precios predecibles.",
  subtitle = "Paquetes claros, sin sorpresas y con tiempos de entrega garantizados. Ideal para pequeñas empresas que valoran su tiempo y su presupuesto.",
  primary = { label: "Solicitar Presupuesto", href: "#contacto" },
  secondary = { label: "Ver Precios", href: "#precios" },
  decorate = false,
} = Astro.props as {
  badgeText?: string;
  titleBefore?: string;
  titleAccent?: string;
  titleAfter?: string;
  subtitle?: string;
  primary?: { label: string; href: string };
  secondary?: { label: string; href: string };
  decorate?: boolean;
};
---
<section id="mw-hero" class="mw-hero relative flex flex-col items-center justify-center text-center min-h-[calc(100vh-5rem)]">
  <div class="container max-w-7xl mx-auto px-6 flex flex-col items-center text-center">
    <!-- Badge -->
    <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-surface-light border border-border-subtle mb-8">
      <span class="relative flex h-2 w-2">
        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"></span>
        <span class="relative inline-flex rounded-full h-2 w-2 bg-primary"></span>
      </span>
      <span class="text-xs font-medium text-text-muted uppercase tracking-wide">{badgeText}</span>
    </div>

    <!-- Title -->
    <h1 class="text-5xl md:text-7xl font-black tracking-tight leading-[1.1] mb-6 text-white max-w-4xl">
      {titleBefore} <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary to-red-400">{titleAccent}</span>{titleAfter}
    </h1>

    <!-- Subtitle -->
    <p class="text-lg md:text-xl text-text-muted max-w-2xl mb-10 leading-relaxed">
      {subtitle}
    </p>

    <!-- CTAs -->
    <div class="flex flex-wrap justify-center gap-4 w-full">
      <a href={primary.href} class="mw-hero__btn inline-flex items-center justify-center h-14 px-8 bg-primary hover:bg-red-700 text-white font-bold text-lg transition-all transform hover:-translate-y-1">
        {primary.label}
      </a>
      <a href={secondary.href} class="mw-hero__btn inline-flex items-center justify-center h-14 px-8 border border-border-subtle bg-surface-light hover:bg-surface-dark text-white font-bold text-lg transition-colors">
        {secondary.label}
      </a>
    </div>
  </div>

  <!-- Cursor glow layer -->
  <div id="mw-hero-cursor" class="mw-hero__cursor"></div>

  {decorate && (
    <div class="mw-hero__decor -z-10">
      <div class="mw-hero__blob mw-hero__blob--primary" style="top:20%; left:20%; width:500px; height:500px;"></div>
    </div>
  )}
</section>

<script>
  // Cursor-following glow: lightweight and disabled on non-hover devices
  const canHover = window.matchMedia('(hover: hover)').matches;
  const hero = document.getElementById('mw-hero');
  const layer = document.getElementById('mw-hero-cursor');

  if (canHover && hero && layer) {
    let raf = 0;
    const setHover = (on: boolean) => {
      hero.setAttribute('data-hover', on ? 'true' : 'false');
    };
    const update = (evt: PointerEvent) => {
      const rect = hero.getBoundingClientRect();
      const x = evt.clientX - rect.left;
      const y = evt.clientY - rect.top;
      layer.style.setProperty('--x', x + 'px');
      layer.style.setProperty('--y', y + 'px');
    };
    hero.addEventListener('pointerenter', () => setHover(true));
    hero.addEventListener('pointerleave', () => setHover(false));
    hero.addEventListener('pointermove', (evt) => {
      cancelAnimationFrame(raf);
      raf = requestAnimationFrame(() => update(evt));
    });
  }
</script>
